<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ù…ÙÙŠØ¯Ø© â€” Ø±ÙØ¹ Ù…Ù„Ù Ø¥Ù„Ù‰ file.io</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Ù…ÙƒØªØ¨Ø© QR Code -->
    <script src="https://cdn.jsdelivr.net/npm/qr-code-styling@1.5.0/lib/qr-code-styling.js"></script>
    <style>
        * {margin:0;padding:0;box-sizing:border-box; font-family: "Noto Kufi Arabic", sans-serif;}
        body {background:linear-gradient(135deg,#f5f7fa 0%,#e4e8f0 100%);color:#333;line-height:1.6;min-height:100vh;padding:20px;}
        .container {max-width:1200px;margin:0 auto;background:#fff;border-radius:20px;box-shadow:0 10px 30px rgba(0,0,0,0.1);padding:30px;}
        header{text-align:center;padding:30px 20px;background:linear-gradient(135deg,#2196f3 0%,#1976d2 100%);border-radius:15px;margin-bottom:30px;color:white;}
        h1{font-size:2.2rem;margin-bottom:10px;}
        .modal {display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1000; align-items: center; justify-content: center;}
        .modal-content {background: white; padding: 30px; border-radius: 15px; width: 90%; max-width: 500px; text-align: center;}
        .modal-content input[type="text"], .modal-content input[type="url"] { width: 100%; padding: 12px; margin: 10px 0; border: 2px solid #ddd; border-radius: 10px; font-size: 16px; text-align: center; }
        .controls{display:flex;gap:10px;margin-bottom:20px;flex-wrap:wrap;}
        .btn{padding:10px 20px;border:none;border-radius:5px;cursor:pointer;font-weight:600;transition:.3s;display:flex;align-items:center;gap:8px}
        .btn-primary{background:linear-gradient(to right,#2196f3,#1976d2);color:#fff;}
        .btn-success{background:linear-gradient(to right,#4caf50,#2e7d32);color:#fff;}
        .btn-info{background:linear-gradient(to right,#ff9800,#f57c00);color:#fff;}
        .btn-danger{background:linear-gradient(to right,#f44336,#d32f2f);color:#fff;}
        .btn-whatsapp{background:linear-gradient(to right,#25D366,#128C7E);color:#fff;}
        .btn:hover{transform:translateY(-2px);box-shadow:0 5px 15px rgba(0,0,0,0.2);}
        .items-container{display:grid;grid-template-columns:repeat(auto-fill,minmax(350px,1fr));gap:20px;margin-top:20px;}
        .item-card{background:white;border-radius:15px;box-shadow:0 5px 15px rgba(0,0,0,0.08);border:1px solid #e0e0e0;padding:20px;text-align:center;}
        .qrcode-container { margin: 15px 0; padding: 10px; background: #f8f9fa; border-radius: 10px; border: 2px dashed #ddd; }
        .item-actions{margin-top:15px;display:flex;gap:10px;justify-content:center;flex-wrap:wrap;}
        .search-box{flex:1;min-width:200px;padding:10px;border:1px solid #ccc;border-radius:8px;}
        footer{text-align:center;margin-top:40px;padding:20px;color:#7f8c8d;font-size:.9rem}
        .instructions { background: #e3f2fd; border-right: 4px solid #2196f3; padding: 15px; margin: 15px 0; border-radius: 8px; text-align: right; }
        .link-url { color: #3498db; word-break: break-all; font-size: 14px; margin: 10px 0; direction: ltr; text-align: center; padding: 8px; background: #f8f9fa; border-radius: 5px; border: 1px solid #e0e0e0; }
        .link-title { color: #2c3e50; margin-bottom: 10px; font-size: 1.3rem; }
        .notification { position: fixed; top: 20px; right: 20px; padding: 12px 16px; background: #4caf50; color: white; border-radius: 6px; display:none; z-index:1200; box-shadow:0 5px 15px rgba(0,0,0,0.1); }
        @media(max-width:768px){ .items-container{grid-template-columns:1fr} .controls{flex-direction:column} .item-actions{flex-direction:column} .modal-content{width:95%;padding:20px;} }
    </style>
</head>
<body>
    <div class="notification" id="notification"></div>

    <div class="container">
        <header>
            <h1><i class="fas fa-link"></i> Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ù…ÙÙŠØ¯Ø©</h1>
            <p>Ù‚Ù… Ø¨Ø¥Ø¯Ø§Ø±Ø© ÙˆÙ…Ø´Ø§Ø±ÙƒØ© Ø±ÙˆØ§Ø¨Ø·Ùƒ Ø§Ù„Ù…Ù‡Ù…Ø© Ù…Ø¹ Ø¨Ø§Ø±ÙƒÙˆØ¯ Ù„Ù„Ù…Ø³Ø­ Ø§Ù„Ø³Ø±ÙŠØ¹</p>
        </header>

        <!-- Ø±ÙˆØ§Ø¨Ø· -->
        <div id="links-tab">
            <div class="instructions">
                <h3><i class="fas fa-info-circle"></i> Ø­ÙˆÙ„ Ø§Ù„Ù†Ø¸Ø§Ù…:</h3>
                <p style="text-align: right;">ÙŠÙ…ÙƒÙ†Ùƒ Ø¥Ø¶Ø§ÙØ© Ø±ÙˆØ§Ø¨Ø· Ù…ÙÙŠØ¯Ø© ÙˆØ³ÙŠØªÙ… ØªÙˆÙ„ÙŠØ¯ Ø¨Ø§Ø±ÙƒÙˆØ¯ Ù„Ù‡Ø§ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ù„Ù„Ù…Ø³Ø­ Ø§Ù„Ø³Ø±ÙŠØ¹. Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ØªØ­ÙØ¸ ÙÙŠ Ù…ØªØµÙØ­Ùƒ.</p>
                <p style="text-align: right; color: #2e7d32; margin-top: 8px;"><i class="fas fa-check-circle"></i> ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø¢Ù† Ø±ÙØ¹ Ù…Ù„ÙØ§Øª ÙˆØ³ÙŠØªÙ… Ø±ÙØ¹Ù‡Ø§ Ø¥Ù„Ù‰ file.io ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹</p>
            </div>

            <div class="controls">
                <button class="btn btn-primary" onclick="showAddLinkModal()"><i class="fas fa-plus"></i> Ø¥Ø¶Ø§ÙØ© Ø±Ø§Ø¨Ø· Ø¬Ø¯ÙŠØ¯</button>
                <button class="btn btn-success" onclick="exportLinks()"><i class="fas fa-download"></i> ØªØµØ¯ÙŠØ± Ø§Ù„Ø±ÙˆØ§Ø¨Ø·</button>
                <button class="btn btn-info" onclick="exportLinksAsJSON()"><i class="fas fa-file-export"></i> ØªØµØ¯ÙŠØ± JSON</button>
                <input type="text" class="search-box" id="searchLinkInput" placeholder="ğŸ” Ø§Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ø±ÙˆØ§Ø¨Ø·" oninput="searchLinks()">
            </div>

            <div class="items-container" id="linksContainer"></div>
        </div>

        <footer>
            <p>Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø­ÙÙˆØ¸Ø© ÙÙŠ Ù…ØªØµÙØ­Ùƒ - ÙŠÙ…ÙƒÙ†Ùƒ Ù…Ø´Ø§Ø±ÙƒØ© Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø¹Ø¨Ø± ÙˆØ§ØªØ³Ø§Ø¨</p>
        </footer>
    </div>

    <!-- Ù…ÙˆØ¯Ø§Ù„ Ø¥Ø¶Ø§ÙØ© Ø±Ø§Ø¨Ø· -->
    <div class="modal" id="addLinkModal">
        <div class="modal-content">
            <h2><i class="fas fa-link"></i> Ø¥Ø¶Ø§ÙØ© Ø±Ø§Ø¨Ø· Ø¬Ø¯ÙŠØ¯ / Ø±ÙØ¹ Ù…Ù„Ù</h2>
            <input type="text" id="linkTitle" placeholder="Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø±Ø§Ø¨Ø· (Ù…Ø«Ø§Ù„: Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø´Ø±ÙƒØ©)">
            <input type="url" id="linkUrl" placeholder="https://example.com">

            <!-- Ø²Ø± Ø±ÙØ¹ Ø§Ù„Ù…Ù„Ù -->
            <div style="margin-top:10px;">
                <label class="btn btn-info" style="cursor:pointer;">
                    <i class="fas fa-file-upload"></i> Ø±ÙØ¹ Ù…Ù„Ù Ù…Ù† Ø¬Ù‡Ø§Ø²Ùƒ
                    <input type="file" id="fileInput" style="display:none" onchange="handleFileSelect(event)">
                </label>
                <small style="display:block;margin-top:8px;color:#666">Ø¨Ø¹Ø¯ Ø§Ù„Ø±ÙØ¹ Ø³ÙŠÙØ¶Ø§Ù Ø§Ù„Ø±Ø§Ø¨Ø· ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ù…Ù† file.io ÙˆØ³ÙŠÙÙ†Ø´Ø£ Ù„Ù‡ QR</small>
            </div>

            <div style="margin-top:20px; display:flex; gap:10px; justify-content:center;">
                <button class="btn btn-primary" onclick="addNewLink()"><i class="fas fa-save"></i> Ø­ÙØ¸ Ø§Ù„Ø±Ø§Ø¨Ø· ÙŠØ¯ÙˆÙŠØ§Ù‹</button>
                <button class="btn" onclick="hideAddLinkModal()" style="background:#ccc;">Ø¥Ù„ØºØ§Ø¡</button>
            </div>
        </div>
    </div>

<script>
let links = [];

/* --- Ø¥Ø´Ø¹Ø§Ø± Ø¨Ø³ÙŠØ· --- */
function showNotification(message, type = 'success') {
    const n = document.getElementById('notification');
    n.textContent = message;
    n.style.display = 'block';
    n.style.background = (type === 'success') ? '#4caf50' : (type === 'error') ? '#f44336' : '#2196f3';
    clearTimeout(n._hideTimeout);
    n._hideTimeout = setTimeout(() => n.style.display = 'none', 4000);
}

/* Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø© */
document.addEventListener('DOMContentLoaded', () => {
    loadDataFromStorage();
    renderLinks();
});

/* Ø­ÙØ¸/ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª */
function saveDataToStorage() {
    localStorage.setItem('usefulLinks', JSON.stringify(links));
}
function loadDataFromStorage() {
    const l = localStorage.getItem('usefulLinks');
    if (l) links = JSON.parse(l);
}

/* ØªÙˆÙ„ÙŠØ¯ QR Code */
function generateQRCode(containerId, data) {
    const container = document.getElementById(containerId);
    if (!container) return;

    try {
        container.innerHTML = ''; // ØªÙØ±ÙŠØº
        const qrCode = new QRCodeStyling({
            width: 150,
            height: 150,
            data: data,
            dotsOptions: { color: "#2196f3", type: "rounded" },
            backgroundOptions: { color: "#ffffff" },
            imageOptions: { crossOrigin: "anonymous", margin: 5 }
        });
        qrCode.append(container);
    } catch (error) {
        console.error('QR Code error:', error);
        container.innerHTML = `<div style="padding:20px;color:#666;background:#f5f5f5;border-radius:5px;">
            <i class="fas fa-qrcode" style="font-size:2rem;"></i><br><small>QR Code ØºÙŠØ± Ù…ØªØ§Ø­</small></div>`;
    }
}

/* Ø¹Ø±Ø¶ Ø§Ù„Ø±ÙˆØ§Ø¨Ø· */
function renderLinks() {
    const container = document.getElementById('linksContainer');
    if (links.length === 0) {
        container.innerHTML = `<div class="item-card" style="text-align:center;color:#666;grid-column:1/-1;">
            <i class="fas fa-link" style="font-size:4rem;margin-bottom:15px;color:#2196f3;"></i>
            <h3>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø±ÙˆØ§Ø¨Ø·</h3>
            <p>Ø§Ù†Ù‚Ø± Ø¹Ù„Ù‰ "Ø¥Ø¶Ø§ÙØ© Ø±Ø§Ø¨Ø· Ø¬Ø¯ÙŠØ¯" Ù„Ø¨Ø¯Ø¡ Ø¥Ø¶Ø§ÙØ© Ø±ÙˆØ§Ø¨Ø·Ùƒ Ø§Ù„Ù…Ù‡Ù…Ø©</p>
            <div style="margin-top:20px;"><button class="btn btn-primary" onclick="showAddLinkModal()"><i class="fas fa-plus"></i> Ø¥Ø¶Ø§ÙØ© Ø£ÙˆÙ„ Ø±Ø§Ø¨Ø·</button></div>
        </div>`;
        return;
    }

    container.innerHTML = links.map(link => `
        <div class="item-card">
            <h3 class="link-title">${escapeHtml(link.title)}</h3>
            <div class="link-url" title="${escapeHtml(link.url)}"><i class="fas fa-link"></i> ${link.url.length > 45 ? escapeHtml(link.url.substring(0,45)) + '...' : escapeHtml(link.url)}</div>
            <div class="qrcode-container"><div id="link-qrcode-${link.id}"></div><p style="margin:10px 0;font-size:12px;color:#666;">QR Code Ù„Ù„Ù…Ø³Ø­ Ø§Ù„Ø³Ø±ÙŠØ¹</p></div>
            <div class="item-actions">
                <button class="btn btn-whatsapp" onclick="shareSingleLink('${escapeJs(link.title)}','${escapeJs(link.url)}')"><i class="fab fa-whatsapp"></i> Ù…Ø´Ø§Ø±ÙƒØ©</button>
                <button class="btn btn-success" onclick="downloadQRCode('${link.id}','${escapeJs(link.title)}')"><i class="fas fa-download"></i> Ø­ÙØ¸ QR</button>
                <button class="btn btn-danger" onclick="deleteLink(${link.id})"><i class="fas fa-trash"></i> Ø­Ø°Ù</button>
            </div>
        </div>
    `).join('');

    // ØªÙˆÙ„ÙŠØ¯ QR Ø¨Ø¹Ø¯ Ø§Ù„Ø¹Ø±Ø¶
    setTimeout(() => {
        links.forEach(link => {
            generateQRCode(`link-qrcode-${link.id}`, link.url);
        });
    }, 300);
}

/* Ø§Ù„Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ø¨Ø³ÙŠØ·Ø© Ù„Ù†Øµ ÙÙŠ HTML/JS */
function escapeHtml(str) {
    return String(str || '').replace(/[&<>"'`=\/]/g, function(s){ return ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"})[s]; });
}
function escapeJs(str) {
    return String(str || '').replace(/\\/g,'\\\\').replace(/'/g,"\\'").replace(/"/g,'\\"').replace(/\n/g,'\\n');
}

/* Ø¥Ø¶Ø§ÙØ© Ø±Ø§Ø¨Ø· ÙŠØ¯ÙˆÙŠ */
function addNewLink() {
    const title = document.getElementById('linkTitle').value.trim();
    const url = document.getElementById('linkUrl').value.trim();

    if (!title) return alert('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø¹Ù†ÙˆØ§Ù† Ù„Ù„Ø±Ø§Ø¨Ø·');
    if (!url) return alert('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø±Ø§Ø¨Ø·');
    if (!url.startsWith('http://') && !url.startsWith('https://')) return alert('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ø§Ø¨Ø· ØµØ­ÙŠØ­ ÙŠØ¨Ø¯Ø£ Ø¨Ù€ http:// Ø£Ùˆ https://');

    const link = { id: Date.now(), title: title, url: url };
    links.push(link);
    saveDataToStorage();
    renderLinks();
    hideAddLinkModal();
    alert('âœ… ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø±Ø§Ø¨Ø· Ø¨Ù†Ø¬Ø§Ø­!');
}

/* Ø­Ø°Ù */
function deleteLink(id) {
    if (!confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ø±Ø§Ø¨Ø·ØŸ')) return;
    links = links.filter(l => l.id !== id);
    saveDataToStorage();
    renderLinks();
}

/* ØªÙ†Ø²ÙŠÙ„ QR */
function downloadQRCode(id, title) {
    const container = document.getElementById(`link-qrcode-${id}`);
    if (container && container.querySelector('canvas')) {
        const canvas = container.querySelector('canvas');
        const a = document.createElement('a');
        a.download = `Ø¨Ø§Ø±ÙƒÙˆØ¯_${(title||'link').replace(/\s+/g,'_')}.png`;
        a.href = canvas.toDataURL();
        a.click();
    } else {
        alert('QR Code ØºÙŠØ± Ø¬Ø§Ù‡Ø² Ù„Ù„ØªØ­Ù…ÙŠÙ„');
    }
}

/* Ù…Ø´Ø§Ø±ÙƒØ© ÙˆØ§ØªØ³Ø§Ø¨ */
function shareSingleLink(title, url) {
    const message = `ğŸ”— ${title}\n${url}`;
    const whatsappUrl = `https://wa.me/?text=${encodeURIComponent(message)}`;
    window.open(whatsappUrl, '_blank');
}

/* Ø§Ù„Ø¨Ø­Ø« */
function searchLinks() {
    const q = document.getElementById('searchLinkInput').value.toLowerCase();
    const filtered = links.filter(l => (l.title||'').toLowerCase().includes(q) || (l.url||'').toLowerCase().includes(q));
    const container = document.getElementById('linksContainer');
    if (filtered.length === 0) {
        container.innerHTML = `<div class="item-card" style="text-align:center;color:#666;grid-column:1/-1;">
            <i class="fas fa-search" style="font-size:3rem;margin-bottom:15px;"></i><h3>Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬</h3><p>Ø¬Ø±Ø¨ ÙƒÙ„Ù…Ø§Øª Ø¨Ø­Ø« Ø£Ø®Ø±Ù‰</p></div>`;
        return;
    }
    container.innerHTML = filtered.map(link => `
        <div class="item-card">
            <h3 class="link-title">${escapeHtml(link.title)}</h3>
            <div class="link-url" title="${escapeHtml(link.url)}"><i class="fas fa-link"></i> ${link.url.length > 45 ? escapeHtml(link.url.substring(0,45)) + '...' : escapeHtml(link.url)}</div>
            <div class="qrcode-container"><div id="link-qrcode-${link.id}"></div><p style="margin:10px 0;font-size:12px;color:#666;">QR Code Ù„Ù„Ù…Ø³Ø­ Ø§Ù„Ø³Ø±ÙŠØ¹</p></div>
            <div class="item-actions">
                <button class="btn btn-whatsapp" onclick="shareSingleLink('${escapeJs(link.title)}','${escapeJs(link.url)}')"><i class="fab fa-whatsapp"></i> Ù…Ø´Ø§Ø±ÙƒØ©</button>
                <button class="btn btn-success" onclick="downloadQRCode('${link.id}','${escapeJs(link.title)}')"><i class="fas fa-download"></i> Ø­ÙØ¸ QR</button>
                <button class="btn btn-danger" onclick="deleteLink(${link.id})"><i class="fas fa-trash"></i> Ø­Ø°Ù</button>
            </div>
        </div>
    `).join('');

    setTimeout(() => { filtered.forEach(link => generateQRCode(`link-qrcode-${link.id}`, link.url)); }, 300);
}

/* --- Ù…Ù„Ù: Ø±ÙØ¹ Ø¥Ù„Ù‰ file.io --- */
function handleFileSelect(event) {
    const file = event.target.files[0];
    if (!file) return;
    uploadFileToFileIo(file);
}

async function uploadFileToFileIo(file) {
    // Ø¥Ø¸Ù‡Ø§Ø± Ø¥Ø´Ø¹Ø§Ø±
    showNotification('Ø¬Ø§Ø±ÙŠ Ø±ÙØ¹ Ø§Ù„Ù…Ù„Ù Ø¥Ù„Ù‰ file.io...', 'info');

    const formData = new FormData();
    formData.append('file', file); // file field ÙƒÙ…Ø§ ÙÙŠ ØªÙˆØ«ÙŠÙ‚ file.io

    try {
        const res = await fetch('https://file.io', {
            method: 'POST',
            body: formData
        });

        if (!res.ok) throw new Error(`HTTP ${res.status}`);

        const json = await res.json();
        // Ø§Ø³ØªØ¬Ø§Ø¨Ø© file.io Ø¹Ø§Ø¯Ø© ØªØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ { success: true, key: "...", link: "https://file.io/xxx", expiry: "14 days" }
        if (json && (json.success || json.link || json.key)) {
            const link = json.link || (json.key ? `https://file.io/${json.key}` : null);
            if (!link) throw new Error('Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø±Ø§Ø¨Ø· Ù…Ù† file.io');

            // Ø§Ø³ØªØ®Ø¯Ù… Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø­Ù‚Ù„ Ø£Ùˆ Ø§Ø³Ù… Ø§Ù„Ù…Ù„Ù ÙƒÙ€ title
            const titleField = document.getElementById('linkTitle').value.trim();
            const title = titleField || file.name || `File ${Date.now()}`;

            addLinkFromUpload(link, title);
            showNotification('âœ… ØªÙ… Ø±ÙØ¹ Ø§Ù„Ù…Ù„Ù ÙˆØ¥Ø¶Ø§ÙØ© Ø§Ù„Ø±Ø§Ø¨Ø· Ø¨Ù†Ø¬Ø§Ø­', 'success');
            hideAddLinkModal();
        } else {
            console.error('file.io response', json);
            throw new Error(json && json.error ? json.error : 'ÙØ´Ù„ Ø§Ù„Ø±ÙØ¹');
        }
    } catch (err) {
        console.error('Upload error:', err);
        showNotification('âŒ ÙØ´Ù„ Ø§Ù„Ø±ÙØ¹: ' + (err.message || err), 'error');
        alert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø±ÙØ¹. Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.');
    } finally {
        // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø­Ù‚Ù„ Ø§Ù„Ù…Ù„Ù
        const fi = document.getElementById('fileInput');
        if (fi) fi.value = '';
    }
}

function addLinkFromUpload(url, title) {
    const link = { id: Date.now(), title: title, url: url };
    links.push(link);
    saveDataToStorage();
    renderLinks();
}

/* Ø¹Ø±Ø¶/Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ù…ÙˆØ¯Ø§Ù„ */
function showAddLinkModal() { document.getElementById('addLinkModal').style.display = 'flex'; }
function hideAddLinkModal() {
    document.getElementById('addLinkModal').style.display = 'none';
    document.getElementById('linkTitle').value = '';
    document.getElementById('linkUrl').value = '';
}

/* ØªØµØ¯ÙŠØ±/Ø§Ø³ØªÙŠØ±Ø§Ø¯ */
function exportLinksAsJSON() {
    const json = JSON.stringify(links, null, 2);
    downloadFile(json, 'Ø±ÙˆØ§Ø¨Ø·-Ù…ÙÙŠØ¯Ø©.json', 'application/json');
    showNotification('ØªÙ… ØªØµØ¯ÙŠØ± JSON', 'success');
}
function exportLinks() {
    if (links.length === 0) return alert("Ù„Ø§ ØªÙˆØ¬Ø¯ Ø±ÙˆØ§Ø¨Ø·");
    let txt = "Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ù…ÙÙŠØ¯Ø©:\n\n";
    links.forEach(l => { txt += `- ${l.title}: ${l.url}\n`; });
    downloadFile(txt, 'Ø±ÙˆØ§Ø¨Ø·-Ù…ÙÙŠØ¯Ø©.txt', 'text/plain');
    showNotification('ØªÙ… ØªØµØ¯ÙŠØ± Ø§Ù„Ù†Øµ', 'success');
}
function downloadFile(content, fileName, type) {
    const blob = new Blob([content], { type });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url; a.download = fileName; document.body.appendChild(a); a.click(); document.body.removeChild(a);
    URL.revokeObjectURL(url);
}
</script>
</body>
</html>
